A continuaci\'on se detalla el pseudo-c\'odigo de la parte principal del algoritmo:

\begin{algorithm}[H]
\caption{Mochilas}
\begin{algorithmic}[1]
\Function{EJ3}{\param{in}{Lista<mochila>}{MOCHILAS} \param{in}{Lista<objeto>}{OBJETOS}}{$\ensuremath{\rightarrow}$ \param{out}{S} {Integer} \param{out}{elementos} {List<Integer>}}
\If{\#(MOCHILAS) == 1} \hfill //O(1)
\state maximizoSimple(MOCHILAS[1],OBJETOS) \hfill //O($K(M[1]) \ast N$)
\endif
\If{\#(MOCHILAS) == 2} \hfill //O(1)
\If{capacidad[M${_1}$] == capacidad[M${_2}$]} \hfill //O(1)
\state maximizoSimple(MOCHILAS[1], OBJETOS) \hfill //O($K(M[1]) \ast N$)
\state maximizoSimple(MOCHILAS[2], OBJETOS) \hfill //O($K(M[2]) \ast N$)
\Else
\state maximizoDoble(MOCHILAS[1],MOCHILAS[2], OBJETOS) \hfill //O(M * N)
\endif
\endif
\If{\#(MOCHILAS) == 3} \hfill //O(1)
\If{capacidad[M${_1}$] == capacidad[M${_2}$] $\wedge$ capacidad[M${_2}$] == capacidad[M${_3}$] } \hfill //O(1)
\state maximizoSimple(MOCHILAS[1], OBJETOS) \hfill //O($K(M[1]) \ast N$)
\state maximizoSimple(MOCHILAS[2], OBJETOS) \hfill //O($K(M[2]) \ast N$)
\state maximizoSimple(MOCHILAS[3], OBJETOS) \hfill //O($K(M[3]) \ast N$)
\Else
\state maximizoTriple(MOCHILAS,OBJETOS) \hfill //O($K(M) \ast N$)
\endif
\endif
\state devolver arrayMaximo.size \hfill //O(N)
\state devolver arrayMaximo \hfill //O(N)
\EndFunction 
\end{algorithmic}
\hrule
\complejidad{$K(M) \ast N$}
\end{algorithm}


\begin{algorithm}[H]
\caption{Mochilas}
\begin{algorithmic}[1]
\Function{MaximizoSimple}{\param{in}{Lista<mochila>}{MOCHILAS} \param{in}{Lista<objeto>}{OBJETOS}}{$\ensuremath{\rightarrow}$ \param{out}{max} {Integer} \param{out}{arrayUsados} {List<Integer>}}
\while{i < \#(OBJETOS)} \hfill //O(N)
\while{j < capacidad(MOCHILAS[1])} \hfill //O(K(M[1]))
\If{j == 0} \hfill //O(1)
\state matriz[OBJETOS[i]][j] $\gets$ 0 \hfill //O(1)
\endif
\If{j > 0 $\wedge$ peso(OBJETOS[i]) $\leq$ j $\wedge$ $\neg$(Usado(OBJETOS[i]))} \hfill //O(1)
\If{i == 0} \hfill //O(1)
\state matriz[OBJETOS[i]][j] $\gets$ OBJETOS[i] \hfill //O(1)
\Else
\state matriz[elemento][j] $\gets$ MAX(valor(OBJETOS[i]) +  \state
matriz[i-1][j - peso(OBJETOS[i])], matriz[i-1][j]) \hfill //O(1)
\endif
\Else
\If{i == 0} \hfill //O(1)
\state matriz[OBJETOS[i]][j] $\gets$ 0 \hfill //O(1)
\Else
\state matriz[elemento][j] $\gets$ matriz[i-1][j] \hfill //O(1)
\endif
\endif
\state j++  \hfill //O(1)
\endwhile
\state i++  \hfill //O(1)
\endwhile
\state columnaActual $\gets$ K(M[1]) \hfill //O(1)
\state filaActual $\gets$ N-1 \hfill //O(1)
\while{filaActual $\geq$ 0 $\wedge$ columnaActual $\geq$ 0}
\If{$\not$(vacia(columnaActual)) $\wedge$ filaActual == 0} \hfill //O(1)
\If{matriz[filaActual][columnaActual]}\hfill //O(1)
\state arrayUsados $\cup$ matriz[filaActual][columnaActual] \hfill //O(1)
\endif
\state filaActual-- \hfill //O(1)
\endif
\If{matriz[filaActual-1][columnaActual] $\neq$ matriz[filaActual][columnaActual] }\hfill //O(1)
\state arrayUsados $\cup$ matriz[filaActual][columnaActual] \hfill //O(1)
\state columnaActual $\gets$ columnaActual - peso(filaActual)  \hfill //O(1)
\state filaActual-- \hfill //O(1)
\Else
\state filaActual-- \hfill //O(1)
\endif
\endwhile
\state max $\gets$ matriz[filaActual-1][columnaActual] \hfill //O(1)
\state devolver max  \hfill //O(1)
\state devolver arrayUsados \hfill //O(N)
\EndFunction 
\end{algorithmic}
\hrule
\complejidad{$K(M[1]) \ast N)$}
\end{algorithm}


\begin{algorithm}[H]
\caption{Mochilas}
\begin{algorithmic}[1]
\Function{MaximizoDoble}{\param{in}{Lista<mochila>}{MOCHILAS} \param{in}{Lista<objeto>}{OBJETOS}}{$\ensuremath{\rightarrow}$ \param{out}{max} {Integer} \param{out}{arrayUsados} {List<Integer>}}
\state cap1 $\gets$ capacidad(M[1]) \hfill //O(1)
\state cap2 $\gets$ capacidad(M[2]) \hfill //O(1)
\state creo entero h $\gets$\hfill //O(1)
\while{h < \#(OBJETOS)} \hfill //O(N)
\state peso $\gets$ peso(OBJETOS[h]) \hfill //O(1)
\state valor $\gets$ valor(OBJETOS[h]) \hfill //O(1)
\state i $\gets$  cap2  \hfill //O(1)
\while{i $\leq$ 0 } \hfill //O(K(M[1]))
\state j $\gets$  cap1  \hfill //O(1)
\while{j $\leq$ 0 } \hfill //O(K(M[2]))
\state creo entero m0 $\gets$ matriz[j][i] \hfill //O(1)
\state creo entero m1 $\gets$ 0 \hfill //O(1)
\state creo entero m2 $\gets$ 0 \hfill //O(1)
\If{j $\geq$ peso } \hfill //O(1)
\state m1 $\gets$ matriz[j-peso][i] \hfill //O(1)
\endif
\If{i $\geq$ peso } \hfill //O(1)
\state m2 $\gets$ matriz[j][i-peso] \hfill //O(1)
\endif
\If{j $\geq$ peso $\wedge$ m1 + valor $\geq$ m0 
$\wedge$ m1 + valor $\geq$ m2 + valor } \hfill //O(1)
\state matriz[j][i] $\gets$ m1 + valor \hfill //O(1)
\Else
\If{i $\geq$ peso $\wedge$ m2 + valor $\geq$ m0 
$\wedge$ m2 + valor $\geq$ m1 + valor } \hfill //O(1)
\state matriz[j][i] $\gets$ m2 + valor \hfill //O(1)
\endif
\If{matriz[j][i] > max } \hfill //O(1)
\state max $\gets$ matriz[j][i] \hfill //O(1)
\state jMax $\gets$ j \hfill //O(1)
\state iMax $\gets$ i \hfill //O(1)
\state objetoMax $\gets$ h \hfill //O(1)
\endif
\endif
\state i++ \hfill //O(1)
\endwhile
\state j++ \hfill //O(1)
\endwhile
\state h++ \hfill //O(1)
\endwhile
\EndFunction 
\end{algorithmic}
\hrule
\complejidad{$[K(M[1]) + K(M[2])] \ast N)$}
\end{algorithm}


\textbf{Aclaraciones:
K = funci\'on capacidad()
M = MOCHILAS
N = \# OBJETOS }